!function(n){var r={};function a(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,a),e.l=!0,e.exports}a.m=n,a.c=r,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=0)}([function(t,e,n){"use strict";n.r(e);var c="#96A2AA",o="#ECF0F3",h=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function s(t,e,n){var r=[];r[0]=t;for(var a=Math.round((e-t)/n),o=1;o<n;o++)r[o]=r[o-1]+a;return r}function u(e,t){return t.map(function(t){return Math.abs(t-e)}).reduce(function(t,e,n,r){return e<r[t]?n:t},0)}function l(t){var e=Math.max(10,Math.pow(10,t.toString().length-1)),n=Math.ceil(t/e)*e;return Math.max(n,Math.round(t/e)*e)}function a(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var m=function(){function e(t){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),f(this,"setup",function(){o.container=document.createElement("div"),o.container.id="".concat(o.name,"_container"),document.getElementById("app").appendChild(o.container),o.canvas=document.createElement("canvas"),o.canvas.id=o.name,o.canvas.addEventListener("mousemove",o.onMouseMove),o.ctx=o.canvas.getContext("2d"),o.ctx.translate(.5,.5),o.container.appendChild(o.canvas),o.resize()}),f(this,"resize",function(){var t=window,e=t.innerWidth,n=t.innerHeight,r=n<e?Math.round(1*e):Math.round(1*n),a=Math.round(o.ratio*r);o.container.style.width=r+"px",o.container.style.height=a+"px",o.canvas.width=r*o.pixelRatio,o.canvas.height=a*o.pixelRatio,o.chart.startX=Math.round(.05*o.canvas.width),o.chart.endX=Math.round(.95*o.canvas.width),o.chart.endY=Math.round(0*o.canvas.height),o.chart.startY=Math.round(.9*o.canvas.height),o.chart.width=o.chart.endX-o.chart.startX,o.chart.height=o.chart.startY-o.chart.endY,o.update(o.data,o.selectedLines)}),f(this,"update",function(t,e){o.data=t;var n=o.data,r=o.chart;o.maxNum=Math.max.apply(Math,a(o.selectedLines.map(function(t){return Math.max.apply(Math,a(n.columns[t]))}))),0!==o.maxNum&&(o.maxValueY=l(o.maxNum),o.itemsNum=n.columns.x.length,o.currentItemsPositions=s(r.startX,r.width,o.itemsNum),o.ctx.clearRect(0,0,o.canvas.width,o.canvas.height),o.drawAxis(),o.drawGridLines(),o.drawDatesLegend(n.columns.x),o.hoverItem&&o.drawHoverGrid(),o.selectedLines.map(function(t){return o.drawChart(n.columns[t],t,n.colors[t])}),o.hoverItem&&o.drawHoverPoints(),o.hoverItem&&o.showTooltip())}),this.chart={},this.ratio=t.ratio,this.data=t.data,this.name=t.name,this.pixelRatio=window.devicePixelRatio||1,this.selectedLines=t.selectedLines}var t,n,r;return t=e,(n=[{key:"drawChart",value:function(t,e,n){var a=this,o=this.chart,i=this.itemsNum;this.ctx.beginPath(),this.ctx.moveTo(o.startX,o.startY),t.map(function(t,e){var n=Math.round(o.height-(t/a.maxValueY*o.height+o.endY)),r=Math.round(o.startX+e/i*o.width);0===e?a.ctx.moveTo(r,n):a.ctx.lineTo(r,n)}),this.ctx.lineCap="round",this.ctx.strokeStyle=n,this.ctx.lineWidth=4,this.ctx.stroke()}}])&&d(t.prototype,n),r&&d(t,r),e}();function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function x(t){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function b(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function w(t,e){return(w=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var M=function(t){function r(t){var c,e,n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),e=this,n=x(r).call(this,t),g(b(c=!n||"object"!==p(n)&&"function"!=typeof n?b(e):n),"update",function(t,e){c.data=t;var n=b(c),r=n.data,a=n.chart;c.maxNum=Math.max.apply(Math,v(c.selectedLines.map(function(t){return Math.max.apply(Math,v(r.columns[t]))}))),0!==c.maxNum&&(c.maxValueY=l(c.maxNum),c.itemsNum=r.columns.x.length,c.currentItemsPositions=s(a.startX,a.width,c.itemsNum),c.ctx.clearRect(0,0,c.canvas.width,c.canvas.height),c.drawAxis(),c.drawGridLines(),c.drawDatesLegend(r.columns.x),c.hoverItem&&c.drawHoverGrid(),c.selectedLines.map(function(t){return c.drawChart(r.columns[t],t,r.colors[t])}),c.hoverItem&&c.drawHoverPoints(),c.hoverItem&&c.showTooltip())}),g(b(c),"onMouseMove",function(t){var e=t.x,n=t.y,r=b(c).chart,a=c.canvas.getBoundingClientRect(),o=(e-Math.round(a.left))*c.pixelRatio,i=(n-Math.round(a.top))*c.pixelRatio;i<r.startY&&i>r.endY&&o>r.startX&&o<r.endX&&(c.hoverItem=u(o,c.currentItemsPositions),requestAnimationFrame(function(){return c.update(c.data,c.selectedLines)}))}),c}var e,n,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}(r,m),e=r,(n=[{key:"drawAxis",value:function(){this.ctx.lineWidth=1,this.ctx.beginPath(),this.ctx.moveTo(this.chart.startX,this.chart.startY),this.ctx.lineTo(this.chart.endX,this.chart.startY),this.ctx.strokeStyle=o,this.ctx.stroke()}},{key:"drawDatesLegend",value:function(t){var o=this;console.log();var e=Math.round(14*+this.pixelRatio);this.ctx.font="".concat(e,"px -apple-system"),this.ctx.fillStyle=c;var i=6<t.length?Math.round(t.length/6):1;t.map(function(t,e){if(!(e%i)){var n=o.chart.startX+e*o.chart.width/o.itemsNum,r=new Date(t),a=h[r.getMonth()]+" "+r.getDate();o.ctx.fillText(a,n,o.chart.startY+.06*o.chart.height)}})}},{key:"drawGridLines",value:function(){var t=Math.round(14*+this.pixelRatio);this.ctx.font="".concat(t,"px -apple-system"),this.ctx.strokeStyle=o,this.ctx.fillStyle=c;for(var e=1;e<=5;e++){var n=this.chart.startY-e*this.chart.height/5,r=this.maxValueY*e/5;this.ctx.fillText(r,this.chart.startX,n-.5*t),this.ctx.beginPath(),this.ctx.moveTo(this.chart.startX,n),this.ctx.lineTo(this.chart.endX,n),this.ctx.stroke()}this.ctx.fillText(0,this.chart.startX,this.chart.startY-.5*t)}},{key:"drawHoverPoints",value:function(){var a=this,o=this.ctx,i=this.hoverItem,c=this.itemsNum,s=this.chart;this.selectedLines.map(function(t){var e=a.data.columns[t][i],n=Math.round(s.height-(e/a.maxValueY*s.height+s.endY)),r=Math.round(s.startX+i/c*s.width);o.beginPath(),o.strokeStyle=a.data.colors[t],o.lineWidth=3,o.moveTo(r,n),o.arc(r,n,6,0,2*Math.PI,!1),o.stroke(),o.beginPath(),o.lineWidth=1,o.fillStyle="#FFFFFF",o.arc(r,n,4,0,2*Math.PI,!1),o.fill()})}},{key:"drawHoverGrid",value:function(){var t=this.ctx,e=this.chart,n=e.startX+this.hoverItem/this.itemsNum*e.width;t.lineWidth=1,t.strokeStyle="#DFE6EB",t.beginPath(),t.moveTo(n,e.startY),t.lineTo(n,e.endY),t.stroke()}},{key:"showTooltip",value:function(){var c=this,t=(this.ctx,this.chart),s=this.hoverItem,e=(t.startX,this.itemsNum,t.width,document.getElementById("tooltip"),document.getElementsByClassName("tooltip-date")[0]),u=document.getElementsByClassName("tooltip-info")[0],n=new Date(this.data.columns.x[s]),r=i[n.getDay()]+", "+h[n.getMonth()]+" "+n.getDate();e.innerHTML=r,u.innerHTML="",this.selectedLines.map(function(t){var e=c.data.columns[t][s],n=c.data.names[t],r=c.data.colors[t],a=document.createElement("div");a.style="\n      color: ".concat(r,";\n    ");var o=document.createElement("div");o.innerHTML=e;var i=document.createElement("div");i.innerHTML=n,a.appendChild(o),a.appendChild(i),u.appendChild(a)})}}])&&y(e.prototype,n),a&&y(e,a),r}();function O(t){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function S(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function P(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function T(t,e){return(T=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function E(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var r,L=function(t){function r(t){var c,e,n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),e=this,n=j(r).call(this,t),E(P(c=!n||"object"!==O(n)&&"function"!=typeof n?P(e):n),"update",function(t,e){c.data=t;var n=P(c),r=n.data,a=n.chart;c.maxNum=Math.max.apply(Math,S(c.selectedLines.map(function(t){return Math.max.apply(Math,S(r.columns[t]))}))),0!==c.maxNum&&(c.maxValueY=l(c.maxNum),c.itemsNum=r.columns.x.length,c.currentItemsPositions=s(a.startX,a.width,c.itemsNum),c.ctx.clearRect(0,0,c.canvas.width,c.canvas.height),c.selectedLines.map(function(t){return c.drawChart(r.columns[t],t,r.colors[t])}),c.ctx.fillStyle="rgba(221, 234, 243, 0.4)",c.ctx.fillRect(c.chart.startX,0,c.chart.width,c.canvas.height))}),E(P(c),"onMouseMove",function(t){var e=t.x,n=t.y,r=P(c).chart,a=c.canvas.getBoundingClientRect(),o=(e-Math.round(a.left))*c.pixelRatio,i=(n-Math.round(a.top))*c.pixelRatio;i<r.startY&&i>r.endY&&o>r.startX&&o<r.endX&&(c.hoverItem=u(o,c.currentItemsPositions),requestAnimationFrame(function(){return c.update(c.data,c.selectedLines)}))}),c}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&T(t,e)}(r,m),r}();(r="http://localhost:3000/chart_data.json",fetch(r).then(function(t){var e=t.headers.get("content-type");if(e&&e.includes("application/json"))return t.json();throw new TypeError("Incorrect data received!")}).then(function(t){return function(t){var e=t[0],n={columns:{}},r=!0,a=!1,o=void 0;try{for(var i,c=e.columns[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var s=i.value,u=s[0];s.shift(),n.columns[u]=s}}catch(t){a=!0,o=t}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n.colors=e.colors,n.names=e.names,n.types=e.types,n}(t)}).catch(function(t){console.log(t)})).then(function(t){return function(a){var o=[],t=a.names;for(var e in t){var n=document.getElementById("controls"),r=document.createElement("input"),i=document.createTextNode(t[e]);r.type="checkbox",r.name=e,r.checked="true",o.push(e),n.appendChild(i),n.appendChild(r),r.addEventListener("change",u)}var c=new M({name:"main_chart",data:a,selectedLines:o,ratio:.5}),s=new L({name:"nav_chart",data:a,selectedLines:o,ratio:.1});function u(t){var e=t.target,n=e.checked,r=e.name;n&&!o.includes(r)&&o.push(r),!n&&o.includes(r)&&o.splice(o.indexOf(r),1),c.update(a,o),s.update(a,o)}window.addEventListener("load",function(){c.setup(),s.setup()}),window.addEventListener("resize",function(){c.resize(),s.resize()})}(t)})}]);