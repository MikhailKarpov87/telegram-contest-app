!function(n){var r={};function a(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,a),e.l=!0,e.exports}a.m=n,a.c=r,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=0)}([function(t,e,n){"use strict";n.r(e);var a="#96A2AA",i="#ECF0F3",c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function h(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var r,l=function(){function n(t,e){var s=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),u(this,"setup",function(){s.chart={},s.dpi=window.devicePixelRatio,s.canvas=document.createElement("canvas"),s.canvas.id="main_chart",s.canvas.addEventListener("mousemove",s.onMouseMove),document.getElementById("app").appendChild(s.canvas),s.canvas.style="\n            width: 100%;\n            height: 100%;\n        ",s.ctx=s.canvas.getContext("2d"),s.resize(),s.fix_dpi(),s.update(s.data,s.selectedLines)}),u(this,"fix_dpi",function(){var t=document.getElementById("main_chart"),e=function(){return+getComputedStyle(t).getPropertyValue("height").slice(0,-2)},n=function(){return+getComputedStyle(t).getPropertyValue("width").slice(0,-2)};s.canvas.setAttribute("width",n()*s.dpi),s.canvas.setAttribute("height",e()*s.dpi),s.ctx.scale(s.dpi,s.dpi)}),u(this,"update",function(t,e){s.data=t;var n,r,a,i=s.data,o=s.chart;(s.maxNum=Math.max.apply(Math,h(s.selectedLines.map(function(t){return Math.max.apply(Math,h(i.columns[t]))}))),0!==s.maxNum)&&(s.maxValueY=(n=s.maxNum,r=Math.max(10,Math.pow(10,n.toString().length-1)),a=Math.ceil(n/r)*r,Math.max(a,Math.round(n/r)*r)),s.itemsNum=i.columns.x.length,s.currentItemsPositions=function(t,e,n){var r=[];r[0]=t;for(var a=Math.round(e/n),i=1;i<n;i++)r[i]=r[i-1]+a;return r}(o.startX,o.width,s.itemsNum),s.ctx.clearRect(0,0,s.canvas.width,s.canvas.height),s.drawAxis(),s.drawGridLines(),s.drawDatesLegend(i.columns.x),s.selectedLines.map(function(t){return s.drawChart(i.columns[t],t,i.colors[t])}),s.hoverItem&&s.drawHoverGrid())}),u(this,"onMouseMove",function(t){var e,n=t.x,r=t.y,a=s.chart,i=s.canvas.getBoundingClientRect(),o=n-Math.round(i.left),c=r-Math.round(i.top);c<a.startY&&c>a.endY&&o>a.startX&&o<a.endX&&(s.hoverItem=(e=o,s.currentItemsPositions.map(function(t){return Math.abs(t-e)}).reduce(function(t,e,n,r){return e<r[t]?n:t},0)),requestAnimationFrame(function(){return s.update(s.data,s.selectedLines)}))}),this.data=t,this.selectedLines=e}var t,e,r;return t=n,(e=[{key:"resize",value:function(){var t=window,e=t.innerWidth,n=t.innerHeight;this.canvas.width=e,this.canvas.height=n*this.dpi,this.chart.startX=Math.round(.05*e),this.chart.endX=Math.round(.95*e),this.chart.endY=Math.round(.05*n),this.chart.startY=Math.round(.95*n),this.chart.width=e,this.chart.height=n}},{key:"drawAxis",value:function(){this.ctx.lineWidth=1,this.ctx.beginPath(),this.ctx.moveTo(this.chart.startX,this.chart.startY),this.ctx.lineTo(this.chart.endX,this.chart.startY),this.ctx.strokeStyle=i,this.ctx.stroke()}},{key:"drawDatesLegend",value:function(t){var i=this;this.ctx.font="".concat(.03*this.chart.height,"px -apple-system"),this.ctx.fillStyle=a;var o=6<t.length?Math.round(t.length/6):1;t.map(function(t,e){if(!(e%o)){var n=i.chart.startX+e*i.chart.width/i.itemsNum,r=new Date(t),a=c[r.getMonth()]+" "+r.getDate();i.ctx.fillText(a,n,i.chart.startY+.03*i.chart.height)}})}},{key:"drawGridLines",value:function(){this.ctx.font="".concat(.03*this.chart.height,"px -apple-system"),this.ctx.strokeStyle=i,this.ctx.fillStyle=a;for(var t=1;t<=5;t++){var e=this.chart.startY-t*this.chart.height/5,n=this.maxValueY*t/5;this.ctx.fillText(n,this.chart.startX,e-.02*this.chart.height),this.ctx.beginPath(),this.ctx.moveTo(this.chart.startX,e),this.ctx.lineTo(this.chart.endX,e),this.ctx.stroke()}this.ctx.fillText(0,this.chart.startX,this.chart.startY-.02*this.chart.height)}},{key:"drawChart",value:function(t,e,a){var i=this,o=this.chart,c=this.itemsNum,s=this.hoverItem;this.ctx.beginPath(),this.ctx.moveTo(o.startX,o.startY),t.map(function(t,e){var n=Math.round(o.height-(t/i.maxValueY*o.height+o.endY)),r=Math.round(o.startX+e/c*o.width);0===e?i.ctx.moveTo(r,n):i.ctx.lineTo(r,n),s&&s===e&&i.drawHoverPoint(r,n,a)}),this.ctx.lineCap="round",this.ctx.strokeStyle=a,this.ctx.lineWidth=3,this.ctx.stroke()}},{key:"drawHoverPoint",value:function(t,e,n){var r=this.ctx;r.closePath(),r.beginPath(),r.arc(t,e,5,0,2*Math.PI,!1),r.closePath(),r.strokeStyle="#FFFFFF",r.beginPath(),r.arc(t,e,2,0,2*Math.PI,!1),r.moveTo(t,e),r.strokeStyle=n}},{key:"drawHoverGrid",value:function(){var t=this.ctx,e=this.chart,n=e.startX+this.hoverItem/this.itemsNum*e.width;t.lineWidth=1,t.strokeStyle="#DFE6EB",t.beginPath(),t.moveTo(n,e.startY),t.lineTo(n,e.endY),t.stroke()}}])&&o(t.prototype,e),r&&o(t,r),n}();(r="http://localhost:3000/chart_data.json",fetch(r).then(function(t){var e=t.headers.get("content-type");if(e&&e.includes("application/json"))return t.json();throw new TypeError("Incorrect data received!")}).then(function(t){return function(t){var e=t[0],n={columns:{}},r=!0,a=!1,i=void 0;try{for(var o,c=e.columns[Symbol.iterator]();!(r=(o=c.next()).done);r=!0){var s=o.value,h=s[0];s.shift(),n.columns[h]=s}}catch(t){a=!0,i=t}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}return n.colors=e.colors,n.names=e.names,n.types=e.types,n}(t)}).catch(function(t){console.log(t)})).then(function(t){return function(a){console.log(a);var i=[],t=a.names;for(var e in t){var n=document.getElementById("controls"),r=document.createElement("input"),o=document.createTextNode(t[e]);r.type="checkbox",r.name=e,r.checked="true",i.push(e),n.appendChild(o),n.appendChild(r),r.addEventListener("change",s)}var c=new l(a,i);function s(t){var e=t.target,n=e.checked,r=e.name;n&&!i.includes(r)&&i.push(r),!n&&i.includes(r)&&i.splice(i.indexOf(r),1),c.update(a,i)}window.addEventListener("load",c.setup),window.addEventListener("resize",c.resize)}(t)})}]);