!function(n){var a={};function r(t){if(a[t])return a[t].exports;var e=a[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=n,r.c=a,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,n){"use strict";n.r(e);var r="#96A2AA",i="#ECF0F3",u=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],o=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function s(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function h(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var a,l=function(){function n(t,e){var c=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),h(this,"setup",function(){c.chart={},c.dpi=window.devicePixelRatio,c.canvas=document.createElement("canvas"),c.canvas.id="main_chart",c.canvas.addEventListener("mousemove",c.onMouseMove),document.getElementById("app").appendChild(c.canvas),c.canvas.style="\n            width: 100%;\n            height: 100%;\n        ",c.ctx=c.canvas.getContext("2d"),c.resize(),c.fix_dpi(),c.update(c.data,c.selectedLines)}),h(this,"fix_dpi",function(){var t=document.getElementById("main_chart"),e=function(){return+getComputedStyle(t).getPropertyValue("height").slice(0,-2)},n=function(){return+getComputedStyle(t).getPropertyValue("width").slice(0,-2)};c.canvas.setAttribute("width",n()*c.dpi),c.canvas.setAttribute("height",e()*c.dpi),c.ctx.scale(c.dpi,c.dpi)}),h(this,"update",function(t,e){c.data=t;var n,a,r,i=c.data,o=c.chart;(c.maxNum=Math.max.apply(Math,s(c.selectedLines.map(function(t){return Math.max.apply(Math,s(i.columns[t]))}))),0!==c.maxNum)&&(c.maxValueY=(n=c.maxNum,a=Math.max(10,Math.pow(10,n.toString().length-1)),r=Math.ceil(n/a)*a,Math.max(r,Math.round(n/a)*a)),c.itemsNum=i.columns.x.length,c.currentItemsPositions=function(t,e,n){var a=[];a[0]=t;for(var r=Math.round((e-t)/n),i=1;i<n;i++)a[i]=a[i-1]+r;return a}(o.startX,o.width,c.itemsNum),c.ctx.clearRect(0,0,c.canvas.width,c.canvas.height),c.drawAxis(),c.drawGridLines(),c.drawDatesLegend(i.columns.x),c.hoverItem&&c.drawHoverGrid(),c.selectedLines.map(function(t){return c.drawChart(i.columns[t],t,i.colors[t])}),c.hoverItem&&c.drawHoverPoints(),c.hoverItem&&c.showTooltip())}),h(this,"onMouseMove",function(t){var e,n=t.x,a=t.y,r=c.chart,i=c.canvas.getBoundingClientRect(),o=n-Math.round(i.left),s=a-Math.round(i.top);s<r.startY&&s>r.endY&&o>r.startX&&o<r.endX&&(c.hoverItem=(e=o,c.currentItemsPositions.map(function(t){return Math.abs(t-e)}).reduce(function(t,e,n,a){return e<a[t]?n:t},0)),requestAnimationFrame(function(){return c.update(c.data,c.selectedLines)}))}),this.data=t,this.selectedLines=e}var t,e,a;return t=n,(e=[{key:"resize",value:function(){var t=window,e=t.innerWidth,n=t.innerHeight;this.canvas.width=e,this.canvas.height=n*this.dpi,this.chart.startX=Math.round(.05*e),this.chart.endX=Math.round(.95*e),this.chart.endY=Math.round(.05*n),this.chart.startY=Math.round(.95*n),this.chart.width=e,this.chart.height=n}},{key:"drawAxis",value:function(){this.ctx.lineWidth=1,this.ctx.beginPath(),this.ctx.moveTo(this.chart.startX,this.chart.startY),this.ctx.lineTo(this.chart.endX,this.chart.startY),this.ctx.strokeStyle=i,this.ctx.stroke()}},{key:"drawDatesLegend",value:function(t){var i=this;this.ctx.font="".concat(.03*this.chart.height,"px -apple-system"),this.ctx.fillStyle=r;var o=6<t.length?Math.round(t.length/6):1;t.map(function(t,e){if(!(e%o)){var n=i.chart.startX+e*i.chart.width/i.itemsNum,a=new Date(t),r=u[a.getMonth()]+" "+a.getDate();i.ctx.fillText(r,n,i.chart.startY+.03*i.chart.height)}})}},{key:"drawGridLines",value:function(){this.ctx.font="".concat(.03*this.chart.height,"px -apple-system"),this.ctx.strokeStyle=i,this.ctx.fillStyle=r;for(var t=1;t<=5;t++){var e=this.chart.startY-t*this.chart.height/5,n=this.maxValueY*t/5;this.ctx.fillText(n,this.chart.startX,e-.02*this.chart.height),this.ctx.beginPath(),this.ctx.moveTo(this.chart.startX,e),this.ctx.lineTo(this.chart.endX,e),this.ctx.stroke()}this.ctx.fillText(0,this.chart.startX,this.chart.startY-.02*this.chart.height)}},{key:"drawChart",value:function(t,e,n){var r=this,i=this.chart,o=this.itemsNum;this.hoverItem;this.ctx.beginPath(),this.ctx.moveTo(i.startX,i.startY),t.map(function(t,e){var n=Math.round(i.height-(t/r.maxValueY*i.height+i.endY)),a=Math.round(i.startX+e/o*i.width);0===e?r.ctx.moveTo(a,n):r.ctx.lineTo(a,n)}),this.ctx.lineCap="round",this.ctx.strokeStyle=n,this.ctx.lineWidth=3,this.ctx.stroke()}},{key:"drawHoverPoints",value:function(){var r=this,i=this.ctx,o=this.hoverItem,s=this.itemsNum,c=this.chart;this.selectedLines.map(function(t){var e=r.data.columns[t][o],n=Math.round(c.height-(e/r.maxValueY*c.height+c.endY)),a=Math.round(c.startX+o/s*c.width);i.beginPath(),i.strokeStyle=r.data.colors[t],i.lineWidth=3,i.moveTo(a,n),i.arc(a,n,5,0,2*Math.PI,!1),i.stroke(),i.beginPath(),i.lineWidth=1,i.fillStyle="#FFFFFF",i.arc(a,n,3,0,2*Math.PI,!1),i.fill()})}},{key:"drawHoverGrid",value:function(){var t=this.ctx,e=this.chart,n=e.startX+this.hoverItem/this.itemsNum*e.width;t.lineWidth=1,t.strokeStyle="#DFE6EB",t.beginPath(),t.moveTo(n,e.startY),t.lineTo(n,e.endY),t.stroke()}},{key:"showTooltip",value:function(){var s=this,t=(this.ctx,this.chart),c=this.hoverItem,e=(t.startX,this.itemsNum,t.width,document.getElementById("tooltip"),document.getElementsByClassName("tooltip-date")[0]),h=document.getElementsByClassName("tooltip-info")[0],n=new Date(this.data.columns.x[c]),a=o[n.getDay()]+", "+u[n.getMonth()]+" "+n.getDate();e.innerHTML=a,h.innerHTML="",this.selectedLines.map(function(t){var e=s.data.columns[t][c],n=s.data.names[t],a=s.data.colors[t],r=document.createElement("div");r.style="\n      color: ".concat(a,";\n    ");var i=document.createElement("div");i.innerHTML=e;var o=document.createElement("div");o.innerHTML=n,r.appendChild(i),r.appendChild(o),h.appendChild(r)})}}])&&c(t.prototype,e),a&&c(t,a),n}();(a="http://localhost:3000/chart_data.json",fetch(a).then(function(t){var e=t.headers.get("content-type");if(e&&e.includes("application/json"))return t.json();throw new TypeError("Incorrect data received!")}).then(function(t){return function(t){var e=t[4],n={columns:{}},a=!0,r=!1,i=void 0;try{for(var o,s=e.columns[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var c=o.value,h=c[0];c.shift(),n.columns[h]=c}}catch(t){r=!0,i=t}finally{try{a||null==s.return||s.return()}finally{if(r)throw i}}return n.colors=e.colors,n.names=e.names,n.types=e.types,n}(t)}).catch(function(t){console.log(t)})).then(function(t){return function(r){console.log(r);var i=[],t=r.names;for(var e in t){var n=document.getElementById("controls"),a=document.createElement("input"),o=document.createTextNode(t[e]);a.type="checkbox",a.name=e,a.checked="true",i.push(e),n.appendChild(o),n.appendChild(a),a.addEventListener("change",c)}var s=new l(r,i);function c(t){var e=t.target,n=e.checked,a=e.name;n&&!i.includes(a)&&i.push(a),!n&&i.includes(a)&&i.splice(i.indexOf(a),1),s.update(r,i)}window.addEventListener("load",s.setup),window.addEventListener("resize",s.resize)}(t)})}]);