!function(n){var r={};function a(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,a),e.l=!0,e.exports}a.m=n,a.c=r,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=0)}([function(t,e,n){"use strict";n.r(e);var c="#96A2AA",o="#ECF0F3",h=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function s(t,e,n){var r=[];r[0]=t;for(var a=Math.round((e-t)/n),o=1;o<n;o++)r[o]=r[o-1]+a;return r}function l(t){var e=Math.max(10,Math.pow(10,t.toString().length-1)),n=Math.ceil(t/e)*e;return Math.max(n,Math.round(t/e)*e)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d=function(){function e(t){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),u(this,"setup",function(){o.canvas=document.createElement("canvas"),o.canvas.id=o.name,o.canvas.addEventListener("mousemove",o.onMouseMove),o.ctx=o.canvas.getContext("2d"),o.ctx.translate(.5,.5),o.container.appendChild(o.canvas),o.resize()}),u(this,"resize",function(){var t=window,e=t.innerWidth,n=t.innerHeight,r=n<e?Math.round(1*e):Math.round(1*n),a=Math.round(o.ratio*r);o.container.style.width=r+"px",o.container.style.height=a+"px",o.canvas.width=r*o.pixelRatio,o.canvas.height=a*o.pixelRatio,o.chart.startX=Math.round(.05*o.canvas.width),o.chart.endX=Math.round(.95*o.canvas.width),o.chart.endY=Math.round(.1*o.canvas.height),o.chart.startY=Math.round(.85*o.canvas.height),o.chart.width=o.chart.endX-o.chart.startX,o.chart.height=o.chart.startY-o.chart.endY,o.update(o.data,o.selectedLines,o.start,o.end)}),this.chart={},this.ratio=t.ratio,this.data=t.data,this.name=t.name,this.lineWidth=4,this.pixelRatio=window.devicePixelRatio||1,this.selectedLines=t.selectedLines,this.container=document.createElement("div"),this.container.id="".concat(this.name,"_container"),document.getElementById("app").appendChild(this.container)}var t,n,r;return t=e,(n=[{key:"drawChart",value:function(t,e,n,o,r){var i=this,c=this.chart,s=this.itemsNum;this.ctx.beginPath(),this.ctx.moveTo(c.startX,c.startY),t.map(function(t,e){var n=Math.round(c.height-(t/i.maxValueY*c.height*.85+c.endY)),r=1===e?o:1,a=Math.round(c.startX+e/s*c.width*r);0===e?i.ctx.moveTo(a,n):i.ctx.lineTo(a,n)}),this.ctx.lineCap="round",this.ctx.strokeStyle=n,this.ctx.lineWidth=this.lineWidth,this.ctx.stroke()}}])&&a(t.prototype,n),r&&a(t,r),e}();function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(t){x(e,t,n[t])})}return e}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function b(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function x(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var w=function(t){function r(t){var h,e,n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),e=this,n=y(r).call(this,t),x(b(h=!n||"object"!==f(n)&&"function"!=typeof n?b(e):n),"update",function(u,t,e,n){h.data=u;var r=b(h).chart;console.log(h.data);var a=function(t,e){if(console.log("test"),t&&e){var n=u.columns.x.length,r=1/n,a=Math.floor(t/r),o=1/n*a;h.firstX=1-(t-o)/r;var i={};for(var c in u.columns){console.log(u.columns[c][a+1]);var s=u.columns[c][a+1]-u.columns[c][a];console.log(s),i[c]=u.columns[c].slice(a),i[c][a]=u.columns[c][a+1]-s*h.firstX}return console.log(p({},u,{columns:i})),p({},u,{columns:i})}}(e,n);h.maxNum=Math.max.apply(Math,m(h.selectedLines.map(function(t){return Math.max.apply(Math,m(a.columns[t]))}))),0!==h.maxNum&&(h.maxValueY=l(h.maxNum),h.itemsNum=a.columns.x.length,h.currentItemsPositions=s(r.startX,r.width,h.itemsNum),h.ctx.clearRect(0,0,h.canvas.width,h.canvas.height),h.drawAxis(),h.drawGridLines(),h.drawDatesLegend(a.columns.x),h.hoverItem&&h.drawHoverGrid(),h.selectedLines.map(function(t){return h.drawChart(a.columns[t],t,a.colors[t],h.firstX)}),h.hoverItem&&h.drawHoverPoints(),h.hoverItem&&h.showTooltip())}),x(b(h),"onMouseMove",function(t){var e,n=t.x,r=t.y,a=b(h).chart,o=h.canvas.getBoundingClientRect(),i=(n-Math.round(o.left))*h.pixelRatio,c=(r-Math.round(o.top))*h.pixelRatio;c<a.startY&&c>a.endY&&i>a.startX&&i<a.endX&&(h.hoverItem=(e=i,h.currentItemsPositions.map(function(t){return Math.abs(t-e)}).reduce(function(t,e,n,r){return e<r[t]?n:t},0)),requestAnimationFrame(function(){return h.update(h.data,h.selectedLines,h.start,h.end)}))}),h.start=.703,h.end=1,h}var e,n,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(r,d),e=r,(n=[{key:"drawAxis",value:function(){this.ctx.lineWidth=1,this.ctx.beginPath(),this.ctx.moveTo(this.chart.startX,this.chart.startY),this.ctx.lineTo(this.chart.endX,this.chart.startY),this.ctx.strokeStyle=o,this.ctx.stroke()}},{key:"drawDatesLegend",value:function(t){var o=this;console.log();var e=Math.round(14*+this.pixelRatio);this.ctx.font="300 ".concat(e,"px BlinkMacSystemFont"),this.ctx.fillStyle=c;var i=6<t.length?Math.round(t.length/6):1;t.map(function(t,e){if(!(e%i)){var n=o.chart.startX+e*o.chart.width/o.itemsNum,r=new Date(t),a=h[r.getMonth()]+" "+r.getDate();o.ctx.fillText(a,n,o.chart.startY+.06*o.chart.height)}})}},{key:"drawGridLines",value:function(){var t=Math.round(14*+this.pixelRatio);this.ctx.font="300 ".concat(t,"px BlinkMacSystemFont"),this.ctx.strokeStyle=o,this.ctx.fillStyle=c;for(var e=1;e<=5;e++){var n=this.chart.startY-e*this.chart.height/5,r=this.maxValueY*e/5;this.ctx.fillText(r,this.chart.startX,n-.5*t),this.ctx.beginPath(),this.ctx.moveTo(this.chart.startX,n),this.ctx.lineTo(this.chart.endX,n),this.ctx.stroke()}this.ctx.fillText(0,this.chart.startX,this.chart.startY-.5*t)}},{key:"drawHoverPoints",value:function(){var a=this,o=this.ctx,i=this.hoverItem,c=this.itemsNum,s=this.chart;this.selectedLines.map(function(t){var e=a.data.columns[t][i],n=Math.round(s.height-(e/a.maxValueY*s.height*.85+s.endY)),r=Math.round(s.startX+i/c*s.width);o.beginPath(),o.strokeStyle=a.data.colors[t],o.lineWidth=3,o.moveTo(r,n),o.arc(r,n,6,0,2*Math.PI,!1),o.stroke(),o.beginPath(),o.lineWidth=1,o.fillStyle="#FFFFFF",o.arc(r,n,4,0,2*Math.PI,!1),o.fill()})}},{key:"drawHoverGrid",value:function(){var t=this.ctx,e=this.chart,n=e.startX+this.hoverItem/this.itemsNum*e.width;t.lineWidth=1,t.strokeStyle="#DFE6EB",t.beginPath(),t.moveTo(n,e.startY),t.lineTo(n,e.endY),t.stroke()}},{key:"showTooltip",value:function(){var c=this,t=(this.ctx,this.chart),s=this.hoverItem,e=(t.startX,this.itemsNum,t.width,document.getElementById("tooltip"),document.getElementsByClassName("tooltip-date")[0]),u=document.getElementsByClassName("tooltip-info")[0],n=new Date(this.data.columns.x[s]),r=i[n.getDay()]+", "+h[n.getMonth()]+" "+n.getDate();e.innerHTML=r,u.innerHTML="",this.selectedLines.map(function(t){var e=c.data.columns[t][s],n=c.data.names[t],r=c.data.colors[t],a=document.createElement("div");a.style="\n      color: ".concat(r,";\n    ");var o=document.createElement("div");o.className="num",o.innerHTML=e;var i=document.createElement("div");i.className="label",i.innerHTML=n,a.appendChild(o),a.appendChild(i),u.appendChild(a)})}}])&&v(e.prototype,n),a&&v(e,a),r}();function M(t){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function O(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function S(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var P=function(t){function c(t){var o,e,n,r,a,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),e=this,n=j(c).call(this,t),o=!n||"object"!==M(n)&&"function"!=typeof n?S(e):n,r=S(o),i=function(t,e){o.data=t;var n=S(o),r=n.data,a=n.chart;o.maxNum=Math.max.apply(Math,O(o.selectedLines.map(function(t){return Math.max.apply(Math,O(r.columns[t]))}))),0!==o.maxNum&&(o.maxValueY=l(o.maxNum),o.itemsNum=r.columns.x.length,o.currentItemsPositions=s(a.startX,a.width,o.itemsNum),o.ctx.clearRect(0,0,o.canvas.width,o.canvas.height),o.selectedLines.map(function(t){return o.drawChart(r.columns[t],t,r.colors[t])}))},(a="update")in r?Object.defineProperty(r,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[a]=i,o.lineWidth=3,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}(c,d),c}();function E(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function T(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var X,_=function(){function e(t){var c=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),T(this,"resize",function(){var t=window,e=t.innerWidth,n=t.innerHeight,r=n<e?Math.round(1*e):Math.round(1*n),a=Math.round(c.ratio*r);c.canvas.width=r*c.pixelRatio,c.canvas.height=a*c.pixelRatio,c.chart.startX=Math.round(.05*c.canvas.width),c.chart.endX=Math.round(.95*c.canvas.width),c.chart.endY=Math.round(.1*c.canvas.height),c.chart.startY=Math.round(.85*c.canvas.height),c.chart.width=c.chart.endX-c.chart.startX,c.chart.height=c.chart.startY-c.chart.endY,requestAnimationFrame(c.update)}),T(this,"update",function(){c.ctx.clearRect(0,0,c.canvas.width,c.canvas.height),c.drawNavOverlay()}),T(this,"onMouseMove",function(t){var e=t.x,n=t.y,r=c.chart,a=c.canvas.getBoundingClientRect(),o=(e-Math.round(a.left))*c.pixelRatio,i=(n-Math.round(a.top))*c.pixelRatio;i<r.startY&&i>r.endY&&o>r.startX&&o<r.endX&&requestAnimationFrame(function(){return c.update()})}),this.chart={},this.ratio=t.ratio,this.controlledChart=t.controlledChart,this.pixelRatio=window.devicePixelRatio||1,this.container=document.getElementById("nav_chart_container"),this.canvas=document.createElement("canvas"),this.canvas.id="nav_chart_controls",this.container.appendChild(this.canvas),this.canvas.addEventListener("mousemove",this.onMouseMove),this.ctx=this.canvas.getContext("2d"),this.resize()}var t,n,r;return t=e,(n=[{key:"drawNavOverlay",value:function(t,e){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="rgba(221, 234, 243, 0.7)",this.ctx.fillRect(this.chart.startX/2-1,0,this.chart.width/2-1,this.chart.height/2)}}])&&E(t.prototype,n),r&&E(t,r),e}();(X="http://192.168.1.116:3000/chart_data.json",fetch(X).then(function(t){var e=t.headers.get("content-type");if(e&&e.includes("application/json"))return t.json();throw new TypeError("Incorrect data received!")}).then(function(t){return function(t){var e=t[0],n={columns:{}},r=!0,a=!1,o=void 0;try{for(var i,c=e.columns[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var s=i.value,u=s[0];s.shift(),n.columns[u]=s}}catch(t){a=!0,o=t}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n.colors=e.colors,n.names=e.names,n.types=e.types,n}(t)}).catch(function(t){console.log(t)})).then(function(t){return function(a){var o=[],t=a.names;for(var e in t){var n=document.getElementById("controls"),r=document.createElement("input"),i=document.createTextNode(t[e]);r.type="checkbox",r.name=e,r.checked="true",o.push(e),n.appendChild(i),n.appendChild(r),r.addEventListener("change",h)}var c=new w({name:"main_chart",data:a,selectedLines:o,ratio:.5}),s=new P({name:"nav_chart",data:a,selectedLines:o,ratio:.15}),u=new _({ratio:.15,controlledChart:c});function h(t){console.log("2");var e=t.target,n=e.checked,r=e.name;n&&!o.includes(r)&&o.push(r),!n&&o.includes(r)&&o.splice(o.indexOf(r),1),c.update(a,o),s.update(a,o)}window.addEventListener("load",function(){c.setup(),s.setup()}),window.addEventListener("resize",function(){c.resize(),s.resize(),u.resize()})}(t)})}]);